<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Vue</title>
    </head>

    <script src="https://unpkg.com/vue@next"></script>

    <body>
        <div id="app">
        </div>
    </body>

    <script type="module">

        const {createApp, reactive, ref, watch, watchEffect} = Vue

        const App = {
            template: `
              <div class="container">
              <button style="margin-left: 10px" @click="handleClick()">按钮</button>
              <button style="margin-left: 10px" @click="handleStop">停止 watch</button>
              <button style="margin-left: 10px" @click="handleStopWatchEffect">停止 watchEffect</button>
              <div style="margin-top: 20px">{{ refData }}</div>
              </div>`
            ,
            setup() {
                let refData = ref(0);

                const handleClick = () => {
                    refData.value += 1
                }

                const stop = watch(refData, (val, oldVal) => {
                    console.log('watch ', refData.value)
                })

                const stopWatchEffect = watchEffect(() => {
                    console.log('watchEffect ', refData.value)
                })

                const handleStop = () => {
                    stop()
                }

                const handleStopWatchEffect = () => {
                    stopWatchEffect()
                }

                return {
                    refData,
                    handleClick,
                    handleStop,
                    handleStopWatchEffect
                }
            }
        }

        createApp(App).mount('#app');

    </script>

</html>
